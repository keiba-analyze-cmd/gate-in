# 🏇 ゲートイン！ タスク一覧

> **最終更新: 2026-02-14**
> このファイルはプロジェクトルートに配置。`git push` で常に最新状態を共有。

---

## 📊 サマリー

| 状態 | 件数 |
|------|------|
| ✅ 完了 | 15 |
| 🔴 未着手 | 42 |
| **合計** | **57** |

### 実施順序（推奨）

```
Phase B-fix  → ✅ 完了（2026-02-14）
Phase C-social → ユーザーFB対応（1週間）← 次はここ
Phase D      → OGP・SNS・マーケ（2週間）
Phase E      → UX改善・パフォーマンス（1ヶ月）
Phase F      → 機能追加（1〜2ヶ月）
Phase G      → 将来機能（3ヶ月〜）
```

---

## ✅ 完了済み（Phase 0〜B）

| # | フェーズ | カテゴリ | タスク | 完了日 |
|---|---------|---------|--------|--------|
| 1 | Phase A | セキュリティ | 管理画面のアクセス制御 | 2026-02 |
| 2 | Phase A | セキュリティ | RLSポリシー総点検（18テーブル） | 2026-02 |
| 3 | Phase A | セキュリティ | 環境変数の管理 | 2026-02 |
| 4 | Phase A | 法務 | 利用規約の作成・掲載 | 2026-02 |
| 5 | Phase A | 法務 | プライバシーポリシー | 2026-02 |
| 6 | Phase A | 法務 | 特定商取引法に基づく表記 | 2026-02 |
| 7 | Phase A | インフラ | 本番ドメイン gate-in.jp 設定 | 2026-02 |
| 8 | Phase B | データ運用 | レースデータ投入フロー（netkeibaスクレイピング） | 2026-02-14 |
| 9 | Phase B | データ運用 | 管理画面レース登録GUI（4タブ） | 2026-02-14 |
| 10 | Phase B | データ運用 | スクレイピングGUI（プレビュー+一括登録+上書き更新） | 2026-02-14 |
| 11 | Phase B | バグ修正 | 発走時刻タイムゾーン（UTC→JST） | 2026-02-14 |
| 12 | Phase B | バグ修正 | VoteSummary クラッシュ（undefined対策） | 2026-02-14 |
| 13 | Phase B | バグ修正 | VoteDistribution APIキー不一致 | 2026-02-14 |
| 14 | B-fix | バグ修正 | 投票集計RLS修正（全ユーザー集計） | 2026-02-14 |
| 15 | B-fix | バグ修正 | ポイント目安に2〜3番人気追加 | 2026-02-14 |

---

## ✅ Phase B-fix: バグ修正（完了）

| # | タスク | 説明 | 状態 | 対象ファイル |
|---|--------|------|------|-------------|
| 14 | 投票集計が自分の分しか表示されない | createAdminClientで全ユーザー集計に修正 | ✅済 | votes/route.ts, page.tsx VoteStats |
| 15 | 獲得ポイント目安に2〜3番人気がない | 2〜3番人気(+100P)行を追加 | ✅済 | races/[raceId]/page.tsx |

---

## ✨ Phase C-social: ユーザーフィードバック対応

| # | タスク | 説明 | 優先度 | 工数 | 対象ファイル |
|---|--------|------|--------|------|-------------|
| 16 | TLコメントにリプライ機能 | タイムラインから直接リプライ。既存parent_idカラム活用 | 🟠高 | 1日 | TimelineItem.tsx, /api/timeline |
| 17 | フォロー/フォロワー一覧ページ | タップ→一覧→ユーザーページ遷移 | 🟠高 | 1日 | 新規: mypage/follows/page.tsx |

---

## 📢 Phase D: OGP・SNS・マーケティング

| # | タスク | 説明 | 優先度 | 工数 |
|---|--------|------|--------|------|
| 18 | OGP画像の動的生成 | レースごとのプレビュー画像 | 🟠高 | 1日 |
| 19 | Twitterカード最適化 | X投稿時のカード表示 | 🟠高 | 0.5日 |
| 20 | SNSシェアボタン | 的中報告をX/Lineでシェア | 🟠高 | 0.5日 |
| 21 | sitemap.xml / robots.txt | 検索エンジン向けサイトマップ | 🟠高 | 0.5日 |
| 22 | ランディングページ | 未ログインユーザー向けLP | 🟠高 | 2日 |
| 23 | Google Analytics導入 | GA4 + Vercel Analytics | 🟠高 | 0.5日 |

---

## 🔧 Phase E: UX改善・パフォーマンス

| # | タスク | 説明 | 優先度 | 工数 |
|---|--------|------|--------|------|
| 24 | 投票確認画面 | 投票前の確認モーダル | 🟠高 | 0.5日 |
| 25 | レース結果画面の改善 | 着順・配当金・的中者一覧 | 🟠高 | 1日 |
| 26 | エラーページ（404/500） | カスタムエラーページ | 🟠高 | 0.5日 |
| 27 | トースト通知 | 投票完了等のフィードバック | 🟡中 | 0.5日 |
| 28 | 投票締切カウントダウン | 発走時刻までのタイマー | 🟡中 | 0.5日 |
| 29 | ローディング・スケルトン表示 | データ読み込み中の骨格UI | 🟡中 | 1日 |
| 30 | 初回ログインチュートリアル | オンボーディング | 🟡中 | 1日 |
| 31 | ページキャッシュ戦略 | ISR/SSGで高速化 | 🟡中 | 1日 |
| 32 | DBインデックス最適化 | votes, comments等 | 🟡中 | 0.5日 |
| 33 | 画像最適化 | アバターのWebP変換 | 🟡中 | 0.5日 |
| 34 | エラー監視の導入 | Sentry or Vercel Analytics | 🟠高 | 0.5日 |
| 35 | APIレート制限 | スパム防止 | 🟠高 | 0.5日 |
| 36 | 入力値バリデーション強化 | XSS対策, zod | 🟠高 | 0.5日 |

---

## ✨ Phase F: 機能追加

| # | タスク | 説明 | 優先度 | 工数 |
|---|--------|------|--------|------|
| 37 | バッジ自動付与ロジック | 条件達成時に自動付与 | 🟠高 | 1日 |
| 38 | ポイントシステム説明ページ | ルール解説ページ | 🟠高 | 0.5日 |
| 39 | 投票変更・取り消し機能 | 締切前に変更可能 | 🟡中 | 1日 |
| 40 | 馬カルテページ | 過去成績・戦績一覧 | 🟡中 | 2日 |
| 41 | レース検索・フィルター | コース・グレード・日付 | 🟡中 | 1日 |
| 42 | ランクアップ通知 | ランク上昇時に通知 | 🟡中 | 0.5日 |
| 43 | 構造化データ（JSON-LD） | レースの構造化データ | 🟡中 | 0.5日 |
| 44 | 月次大会の自動作成 | 毎月1日にcontest作成 | 🟠高 | 0.5日 |
| 45 | 月次ポイントリセット | 毎月1日にリセット | 🟠高 | 0.5日 |

---

## 🚀 Phase G: 将来の機能

| # | タスク | 説明 | 優先度 | 工数 |
|---|--------|------|--------|------|
| 46 | JRA-VAN API連携 | レースデータ自動取得 | 🟡中 | 5日 |
| 47 | AI予想機能 | 過去データに基づくAI予想 | 🟢低 | 5日 |
| 48 | PWA対応 | ホーム画面追加・オフライン | 🟡中 | 1日 |
| 49 | リアルタイムチャット | レース中ライブチャット | 🟢低 | 3日 |
| 50 | プッシュ通知 | ブラウザ通知 | 🟢低 | 2日 |
| 51 | 予想の公開・非公開設定 | 投票の公開制御 | 🟢低 | 1日 |
| 52 | 広告枠の設計 | AdSense or アフィリエイト | 🟢低 | 2日 |
| 53 | プレミアム会員プラン | Stripe連携 月額課金 | 🟢低 | 5日 |
| 54 | 管理ダッシュボード強化 | KPIダッシュボード | 🟡中 | 2日 |
| 55 | E2Eテスト自動化 | Playwright | 🟡中 | 3日 |
| 56 | CI/CDパイプライン | GitHub Actions | 🟡中 | 1日 |
| 57 | ネイティブアプリ化 | React Native等 | 🟢低 | 20日 |

---

## 📝 更新履歴

| 日付 | 内容 |
|------|------|
| 2026-02-14 | Phase B-fix 完了（バグ2件: 投票集計RLS修正、ポイント目安2〜3番人気追加） |
| 2026-02-14 | Phase B 完了。ユーザーFBからバグ2件+新機能2件追加。ロードマップ再構成 |
| 2026-02-13 | Phase A 完了。Phase B 着手 |
| 2026-02-12 | 初版作成（53タスク） |
